# æ¨¡å— 17ï¼šå¤š Agent åä½œ

## ğŸ¯ å­¦ä¹ ç›®æ ‡

æœ¬æ¨¡å—å°†å¸®åŠ©ä½ ç†è§£å¦‚ä½•åœ¨ LangGraph ä¸­åˆ›å»ºå¤šä¸ªä¸“ä¸šåŒ– Agentï¼Œå¹¶è®©å®ƒä»¬åä½œå®Œæˆå¤æ‚ä»»åŠ¡ã€‚

## ğŸ“š æ ¸å¿ƒæ¦‚å¿µ

### ä¸ºä»€ä¹ˆéœ€è¦å¤š Agentï¼Ÿ

å•ä¸ª Agent åœ¨å¤„ç†å¤æ‚ä»»åŠ¡æ—¶å¯èƒ½å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
- **ä¸Šä¸‹æ–‡è¿‡è½½**ï¼šå•ä¸ª Agent éœ€è¦å¤„ç†æ‰€æœ‰ç±»å‹çš„ä»»åŠ¡
- **ä¸“ä¸šæ€§ä¸è¶³**ï¼šéš¾ä»¥åœ¨æ‰€æœ‰é¢†åŸŸéƒ½è¡¨ç°å‡ºè‰²
- **ç»´æŠ¤å›°éš¾**ï¼šå•ä¸€åºå¤§çš„ Agent éš¾ä»¥è°ƒè¯•å’Œä¼˜åŒ–

å¤š Agent æ¶æ„é€šè¿‡**åˆ†è€Œæ²»ä¹‹**çš„ç­–ç•¥è§£å†³è¿™äº›é—®é¢˜ã€‚

### å¸¸è§çš„å¤š Agent æ¨¡å¼

#### 1. ç›‘ç£è€…æ¨¡å¼ï¼ˆSupervisor Patternï¼‰

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Supervisor  â”‚
                    â”‚   (åè°ƒè€…)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Agent A    â”‚ â”‚  Agent B    â”‚ â”‚  Agent C    â”‚
    â”‚  (ç ”ç©¶å‘˜)    â”‚ â”‚  (ç¼–è¾‘)     â”‚ â”‚  (å®¡æ ¸å‘˜)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **Supervisor**ï¼šæ¥æ”¶ä»»åŠ¡ï¼Œå†³å®šåˆ†é…ç»™å“ªä¸ª Agent
- **Worker Agents**ï¼šä¸“æ³¨äºç‰¹å®šç±»å‹çš„ä»»åŠ¡

#### 2. åä½œæ¨¡å¼ï¼ˆCollaborative Patternï¼‰

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Agent A    â”‚â”€â”€â”€â”€â–¶â”‚  Agent B    â”‚
    â”‚  (å†™åˆç¨¿)    â”‚     â”‚  (å®¡æ ¸ä¿®æ”¹)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Agent C    â”‚
                        â”‚  (æœ€ç»ˆç¡®è®¤)  â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- Agent æŒ‰é¡ºåºå¤„ç†ä»»åŠ¡
- æ¯ä¸ª Agent çš„è¾“å‡ºæ˜¯ä¸‹ä¸€ä¸ª Agent çš„è¾“å…¥

#### 3. å±‚çº§æ¨¡å¼ï¼ˆHierarchical Patternï¼‰

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Manager    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â–¼                               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Team Lead Aâ”‚                 â”‚  Team Lead Bâ”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
      â–¼         â–¼                     â–¼         â–¼
   Agent 1   Agent 2              Agent 3   Agent 4
```

### å®ç°å¤š Agent çš„å…³é”®ç»„ä»¶

```python
from langchain.agents import create_agent
from langgraph.graph import StateGraph

# 1. å®šä¹‰å…±äº«çŠ¶æ€
class TeamState(TypedDict):
    task: str
    current_agent: str
    messages: list
    final_result: str

# 2. åˆ›å»ºä¸“ä¸šåŒ– Agent
researcher = create_agent(
    model="openai:gpt-4o",
    tools=[search_tool, wikipedia_tool],
    system_prompt="ä½ æ˜¯ä¸€ä¸ªç ”ç©¶å‘˜ï¼Œä¸“é—¨æ”¶é›†å’Œæ•´ç†ä¿¡æ¯ã€‚"
)

writer = create_agent(
    model="openai:gpt-4o",
    tools=[],
    system_prompt="ä½ æ˜¯ä¸€ä¸ªä½œå®¶ï¼Œæ“…é•¿å°†ä¿¡æ¯ç»„ç»‡æˆæ¸…æ™°çš„æ–‡ç« ã€‚"
)

# 3. åˆ›å»ºç›‘ç£è€…é€»è¾‘
def supervisor(state: TeamState) -> str:
    # å†³å®šä¸‹ä¸€ä¸ªæ‰§è¡Œçš„ Agent
    if "éœ€è¦ç ”ç©¶" in state["task"]:
        return "researcher"
    elif "éœ€è¦å†™ä½œ" in state["task"]:
        return "writer"
    else:
        return "end"
```

## ğŸ”‘ å…³é”® API

### ä½¿ç”¨ send() è¿›è¡ŒåŠ¨æ€åˆ†å‘

```python
from langgraph.types import Send

def supervisor(state: State):
    """å°†ä»»åŠ¡åˆ†å‘ç»™å¤šä¸ª Agent"""
    return [
        Send("agent_a", {"task": "å­ä»»åŠ¡1"}),
        Send("agent_b", {"task": "å­ä»»åŠ¡2"})
    ]
```

### Agent é—´é€šä¿¡

```python
# é€šè¿‡çŠ¶æ€ä¼ é€’ä¿¡æ¯
class SharedState(TypedDict):
    messages: Annotated[list, add_messages]
    agent_outputs: dict  # å­˜å‚¨å„ Agent çš„è¾“å‡º
```

## ğŸ“ æœ¬æ¨¡å—ç¤ºä¾‹

### main.py

å®ç°äº†ä¸€ä¸ª**å†…å®¹åˆ›ä½œå›¢é˜Ÿ**ï¼š
1. **ç ”ç©¶å‘˜ Agent**ï¼šæ”¶é›†ç›¸å…³ä¿¡æ¯
2. **ä½œå®¶ Agent**ï¼šæ’°å†™å†…å®¹
3. **ç¼–è¾‘ Agent**ï¼šå®¡æ ¸å’Œä¼˜åŒ–
4. **ç›‘ç£è€…**ï¼šåè°ƒæ•´ä¸ªæµç¨‹

## ğŸ§ª ç»ƒä¹ 

1. æ·»åŠ ä¸€ä¸ª"ç¿»è¯‘ Agent"ï¼Œå°†æœ€ç»ˆå†…å®¹ç¿»è¯‘æˆè‹±æ–‡
2. å®ç°å¹¶è¡Œæ‰§è¡Œï¼šè®©ç ”ç©¶å‘˜å’Œä½œå®¶åŒæ—¶å·¥ä½œ
3. æ·»åŠ äººå·¥å®¡æ ¸èŠ‚ç‚¹ï¼ˆHuman-in-the-loopï¼‰

## ğŸ“– å»¶ä¼¸é˜…è¯»

- [LangGraph å¤š Agent æ•™ç¨‹](https://docs.langchain.com/oss/python/langgraph/tutorials/multi_agent)
- [Agent åä½œæ¨¡å¼](https://blog.langchain.com/multi-agent-collaboration/)

## âš ï¸ æ³¨æ„äº‹é¡¹

1. åˆç†åˆ’åˆ† Agent èŒè´£ï¼Œé¿å…åŠŸèƒ½é‡å 
2. è®¾ç½®åˆç†çš„è¿­ä»£ä¸Šé™ï¼Œé˜²æ­¢æ— é™å¾ªç¯
3. ç›‘æ§ token ä½¿ç”¨ï¼Œå¤š Agent ä¼šæ¶ˆè€—æ›´å¤š token
4. è€ƒè™‘æ·»åŠ é”™è¯¯å¤„ç†å’Œå›é€€æœºåˆ¶
